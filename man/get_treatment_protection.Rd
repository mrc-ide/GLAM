% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{get_treatment_protection}
\alias{get_treatment_protection}
\title{Compute time-varying protection from repeated treatments}
\usage{
get_treatment_protection(
  observation_times,
  treatment_times,
  treatment_duration_90,
  treatment_duration_50,
  max_protection = 1
)
}
\arguments{
\item{observation_times}{A numeric vector of observation times (e.g., in days) at which protection is evaluated.}

\item{treatment_times}{A numeric vector of treatment times (must be on the same time scale as \code{observation_times}).}

\item{treatment_duration_90}{Time at which protection is still at 90\% of \code{max_protection} after a treatment. Must be less than \code{treatment_duration_50}.}

\item{treatment_duration_50}{Time (in the same units as \code{observation_times}) at which protection wanes to 50\% of \code{max_protection} after a treatment. Must be greater than \code{treatment_duration_90}.}

\item{max_protection}{The maximum protection conferred immediately after treatment (default is 1.0).}
}
\value{
A numeric vector of the same length as \code{observation_times}, containing the estimated protection at each time point.
}
\description{
This function calculates protective efficacy at a series of observation times, based on a set of treatment times. Protection is modelled as a sigmoidal (logistic) waning curve that resets to \code{max_protection} at each treatment time, and declines from that point forward until the next treatment.
}
\details{
The protection at any observation time is computed using a logistic function:
\deqn{Protection(t) = \frac{P_{\text{max}}}{1 + \exp(k \cdot (t - t_{50}))}}
where \eqn{k = \log(9)/(t_{50} - t_{90})} ensures that protection equals 90\% at \code{treatment_duration_90} and 50\% at \code{treatment_duration_50}
after each treatment. If no treatment has occurred by an observation time, protection is zero.
}
\examples{
obs_times <- seq(0, 100, by = 1)
tx_times <- c(10, 40, 70)
protection <- get_treatment_protection(
  observation_times = obs_times,
  treatment_times = tx_times,
  treatment_duration_90 = 10,
  treatment_duration_50 = 20
)
plot(obs_times, protection, type = "l", main = "Waning Protection", ylab = "Protection")
abline(v = tx_times, col = "blue", lty = 2)

}
